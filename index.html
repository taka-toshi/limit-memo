<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="n文字制限メモアプリ - PC・スマホ同期対応">
  <meta name="theme-color" content="#2196F3">

  <title>Memo App - n文字制限メモ</title>

  <!-- PWA Manifest -->

  <!-- Icons -->

  <!-- Stylesheet -->
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="css/style.css">

  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
</head>

<body>
  <div class="container">
    <header>
      <h1>📝 Memo App</h1>
      <p class="subtitle">n文字制限メモ - クラウド同期対応</p>
    </header>

    <main>
      <!-- オフライン通知 -->
      <div id="offlineIndicator" class="offline-indicator" style="display: none;">
        ⚠️ オフラインモード - ローカルのみで動作中
      </div>

      <!-- 入力制限設定 -->
      <section class="limit-settings">
        <h2>入力制限設定</h2>
        <div class="settings-group">
          <label for="limitType">制限タイプ:</label>
          <select id="limitType">
            <option value="CHAR" selected>文字数</option>
            <option value="BYTE">バイト数</option>
          </select>

          <label for="limitValue">制限値:</label>
          <input type="number" id="limitValue" value="200" min="1" max="10000">
        </div>
      </section>

      <!-- メモ入力エリア -->
      <section class="memo-section">
        <h2>メモ</h2>
        <textarea id="memoInput" placeholder="ここにメモを入力してください..." spellcheck="false"></textarea>

        <!-- カウント表示 -->
        <div class="count-info">
          <span id="charCount">0 文字</span> /
          <span id="byteCount">0 バイト</span>
        </div>
        <div id="limitInfo" class="limit-info">
          制限: 0 / 200 文字 (残り 200)
        </div>
      </section>

      <!-- 同期コントロール -->
      <section class="sync-section">
        <h2>クラウド同期</h2>
        <div class="sync-controls">
          <button id="loginBtn" class="btn btn-primary">GitHub でログイン</button>
          <button id="logoutBtn" class="btn btn-secondary" style="display: none;">ログアウト</button>
          <button id="syncBtn" class="btn btn-sync" style="display: none;">🔄 同期</button>
          <button id="deleteAccountBtn" class="btn btn-danger" style="display: none;">アカウント削除</button>
        </div>
        <div id="syncStatus" class="sync-status"></div>
      </section>
      <section class="local-section">
        <h2>ローカル</h2>
        <button id="clearMemoBtn" class="btn btn-warning">ローカルデータ削除</button>
        <div id="clearMemoConfirm"
          style="display:none;margin-top:8px;padding:8px;border:1px solid #e0e0e0;background:#fff8e1;">
          <div>ローカルに保存されたメモを完全に削除します。復元できません。よろしいですか？</div>
          <div style="margin-top:8px;">
            <button id="confirmClearMemoBtn" class="btn">削除する</button>
            <button id="cancelClearMemoBtn" class="btn" style="margin-left:8px;">キャンセル</button>
          </div>
        </div>
      </section>

      <!-- 説明 -->
      <section class="info-section">
        <h2>使い方</h2>
        <ul>
          <li><strong>ローカル保存:</strong> 入力内容は自動的に端末に保存されます</li>
          <li><strong>クラウド同期:</strong> GitHub でログインすると、複数端末でメモを共有できます</li>
          <li><strong>オフライン対応:</strong> ネットワーク接続がなくても使用できます</li>
          <li><strong>PWA対応:</strong> ホーム画面に追加してアプリのように使用できます</li>
        </ul>

        <h3>認証（Firebase + GitHub）</h3>
        <p>
          このアプリは Firebase Authentication を通じて GitHub にサインインします。
          「GitHub でログイン」ボタンを押すと、GitHub の認可画面がポップアップで開きます。
        </p>
        <ol>
          <li>画面の「GitHub でログイン」ボタンをクリック</li>
          <li>表示される GitHub の認可画面でアクセス許可（gist スコープ）を承認</li>
          <li>承認が完了するとポップアップが閉じ、アプリに戻ります</li>
          <li>自動でトークンが取得され、同期が可能になります</li>
        </ol>
        <p class="note">
          参考: 開発時の簡易方法として Personal Access Token を一時利用できますが、本番公開アプリでは推奨されません。
        </p>
      </section>
    </main>

    <footer>
      <p>&copy; 2026 Memo App - n文字制限メモアプリ</p>
      <p><a href="privacy.html" target="_blank" rel="noopener">プライバシーポリシー</a></p>
    </footer>
  </div>

  <!-- JavaScript (ES Modules) -->
  <!-- Firebase compat SDK を CDN から読み込みします.
       Firebase のプロジェクト設定（apiKey 等）は `js/config.js` の
       `CONFIG.FIREBASE` に記述してください。Auth の初期化は
       `js/services/AuthManager.js` が行います。 -->
  <script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-auth-compat.js"></script>
  <script type="module" src="js/app.js"></script>
</body>

</html>